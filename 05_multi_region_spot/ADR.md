# マルチリージョンで運用するDB on SpotInstance

## 基本的な構成

### 何をしているか

- スポットインスタンス上にデータベースを構築
- 中断時、中断を検知しデータをメインリージョンのS3に退避 → 別のリージョンでスポットインスタンスを起動し、退避したデータを読み込む

### FAQ

```
Q1 なぜ複数リージョンで運用？　　
A1 単一リージョンだと一度中断が起こると即座に再起動しにくい（そのリージョンでの容量が切迫しているため）容量が余っているリージョンに移動することが目的
```

```
Q2 12時間に一回意図的に再配置を行う理由は？
A2 12時間以上生存できるスポットインスタンスは少ない。再配置を行うことで、急遽起こる中断を減らす意図
```

```
Q3 データ転送にmysqldumpを用いている。スナップショットも取っている。どちらかのみの採用でいい上に、スナップショットを定期的に取って、中断時に送信する方が早いのでは？
A3 mysqldumpはsqlの生データを送ることができる。コードがあるのでdiffを取って差分転送などの応用が利く（実際に実装はしていないが、）。一方で、スナップショットは早いが、内部がブラックボックス化しているため、今回はバックアップを取るためだけに利用している。（バックアップを取っているが、そこから復旧を行う機能は実装していない）
```
